#!/usr/bin/python3

#
# Copyright (C) 2023 Nethesis S.r.l.
# SPDX-License-Identifier: GPL-2.0-only
#

import os
import sys

def slurp(path):
    with open(path) as fp:
        return fp.read()

instance=sys.argv[1]
user=sys.argv[2]

cert_dir=f"/etc/openvpn/{instance}/pki"

print(slurp(os.path.join(cert_dir, "ca.crt")))
print(slurp(os.path.join(cert_dir, f"issued/{user}.crt")))
print(slurp(os.path.join(cert_dir, f"private/{user}.key")))
